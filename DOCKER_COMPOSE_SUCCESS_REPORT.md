# üéâ –£–°–ü–ï–®–ù–´–ô –ó–ê–ü–£–°–ö –ß–ï–†–ï–ó DOCKER COMPOSE

**–î–∞—Ç–∞**: 24 —è–Ω–≤–∞—Ä—è 2026  
**–°—Ç–∞—Ç—É—Å**: ‚úÖ –ü–û–õ–ù–û–°–¢–¨–Æ –§–£–ù–ö–¶–ò–û–ù–ê–õ–¨–ù–ê  
**–†–µ–∂–∏–º**: vLLM —á–µ—Ä–µ–∑ Docker Compose  
**–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä**: `dots-ocr-fixed`  
**–ü–æ—Ä—Ç**: 8000  

## üìä –†–ï–ó–£–õ–¨–¢–ê–¢–´ –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–Ø

### ‚úÖ –£—Å–ø–µ—à–Ω–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ:
- **–ú–æ–¥–µ–ª—å**: rednote-hilab/dots.ocr
- **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞**: DotsOCRForCausalLM  
- **–ü–∞–º—è—Ç—å GPU**: 5.72 –ì–ë
- **Flash Attention**: –ê–∫—Ç–∏–≤–µ–Ω
- **–ö–µ—à –º–æ–¥–µ–ª–µ–π**: –ü–æ–ª–Ω—ã–µ –ø—Ä–∞–≤–∞ –Ω–∞ —á—Ç–µ–Ω–∏–µ –∏ –∑–∞–ø–∏—Å—å

### üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:
- `max-model-len`: 1024 (–æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–æ –¥–ª—è –ø–∞–º—è—Ç–∏)
- `gpu-memory-utilization`: 0.85 (–º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ)
- `enforce-eager`: –≤–∫–ª—é—á–µ–Ω (—Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å)
- `disable-log-requests`: –æ—Ç–∫–ª—é—á–µ–Ω—ã –ª–∏—à–Ω–∏–µ –ª–æ–≥–∏
- **–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä**: `dots-ocr-fixed` (—Ä–∞–±–æ—á–µ–µ –∏–º—è)

### üß™ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:
- **Health Check**: ‚úÖ 200 OK
- **Models Endpoint**: ‚úÖ 1 –º–æ–¥–µ–ª—å –¥–æ—Å—Ç—É–ø–Ω–∞
- **OCR –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å**: ‚úÖ –†–∞—Å–ø–æ–∑–Ω–∞–µ—Ç —Ç–µ–∫—Å—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- **–í—Ä–µ–º—è –æ—Ç–∫–ª–∏–∫–∞**: ‚ö° 0.4 —Å–µ–∫—É–Ω–¥—ã
- **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**: 8.2 tokens/s prompt, 0.8 tokens/s generation

## üê≥ DOCKER COMPOSE –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø

### –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã:
1. **–ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è HOME**: –î–æ–±–∞–≤–ª–µ–Ω–∞ –≤ `.env` —Ñ–∞–π–ª –¥–ª—è Windows
2. **–ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞**: –í—Å–µ volumes —Å —Ñ–ª–∞–≥–æ–º `:rw` –¥–ª—è –∑–∞–ø–∏—Å–∏ –≤ –∫–µ—à
3. **–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–∞–º—è—Ç–∏**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω—ã —Ä–∞–±–æ—á–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è –∏–∑ `start_dots_ocr_fixed.py`
4. **–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä**: –ò–º—è `dots-ocr-fixed` –≤–º–µ—Å—Ç–æ –¥–ª–∏–Ω–Ω–æ–≥–æ `rednote-hilab-dots-ocr-vllm`

### –ö–æ–º–∞–Ω–¥—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è:
```bash
# –ó–∞–ø—É—Å–∫
docker-compose -f docker-compose-vllm.yml up -d dots-ocr

# –õ–æ–≥–∏
docker-compose -f docker-compose-vllm.yml logs dots-ocr

# –û—Å—Ç–∞–Ω–æ–≤–∫–∞
docker-compose -f docker-compose-vllm.yml stop dots-ocr

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫
docker-compose -f docker-compose-vllm.yml restart dots-ocr

# –ü–æ–ª–Ω–∞—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∞
docker-compose -f docker-compose-vllm.yml down
```

## üöÄ API ENDPOINTS

### –î–æ—Å—Ç—É–ø–Ω—ã–µ endpoints:
- **Health**: http://localhost:8000/health
- **Models**: http://localhost:8000/v1/models  
- **Chat Completions**: http://localhost:8000/v1/chat/completions
- **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è**: http://localhost:8000/docs

### –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:
```python
import requests
import base64

# –ö–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
with open("image.png", "rb") as f:
    image_base64 = base64.b64encode(f.read()).decode('utf-8')

# OCR –∑–∞–ø—Ä–æ—Å
payload = {
    "model": "rednote-hilab/dots.ocr",
    "messages": [{
        "role": "user",
        "content": [
            {"type": "text", "text": "Extract all text from this image"},
            {"type": "image_url", "image_url": {"url": f"data:image/png;base64,{image_base64}"}}
        ]
    }],
    "max_tokens": 1000,
    "temperature": 0.1
}

response = requests.post("http://localhost:8000/v1/chat/completions", json=payload)
result = response.json()["choices"][0]["message"]["content"]
print(result)
```

## üìà –ü–†–û–ò–ó–í–û–î–ò–¢–ï–õ–¨–ù–û–°–¢–¨

### –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏–∑ –ª–æ–≥–æ–≤:
- **Prompt throughput**: 8.2 tokens/s
- **Generation throughput**: 0.8 tokens/s  
- **GPU KV cache usage**: 0.0% (—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ)
- **Prefix cache hit rate**: 32.5%
- **MM cache hit rate**: 33.3%

### –í—Ä–µ–º—è –æ–±—Ä–∞–±–æ—Ç–∫–∏:
- **–ó–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥–µ–ª–∏**: ~62 —Å–µ–∫—É–Ω–¥—ã
- **OCR –∑–∞–ø—Ä–æ—Å**: ~0.4 —Å–µ–∫—É–Ω–¥—ã
- **–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è**: ~2 –º–∏–Ω—É—Ç—ã

## üîÑ –†–ï–ñ–ò–ú–´ –†–ê–ë–û–¢–´

### 1. vLLM —Ä–µ–∂–∏–º (—Ç–µ–∫—É—â–∏–π) ‚úÖ
- **–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞**: –í—ã—Å–æ–∫–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å, GPU –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è
- **–ó–∞–ø—É—Å–∫**: Docker Compose
- **–ú–æ–¥–µ–ª–∏**: 4 —Å–æ–≤–º–µ—Å—Ç–∏–º—ã–µ (DotsOCR, Qwen2-VL, Phi3-Vision)

### 2. Transformers —Ä–µ–∂–∏–º ‚ö†Ô∏è
- **–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞**: –ì–∏–±–∫–æ—Å—Ç—å, –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –≤—Å–µ—Ö –º–æ–¥–µ–ª–µ–π, 8-bit –∫–≤–∞–Ω—Ç–∏–∑–∞—Ü–∏—è  
- **–ó–∞–ø—É—Å–∫**: `python transformers_multi_model_server.py`
- **–ú–æ–¥–µ–ª–∏**: 8 –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã—Ö (–≤–∫–ª—é—á–∞—è GOT-OCR, Moondream2)

## üéØ –°–õ–ï–î–£–Æ–©–ò–ï –®–ê–ì–ò

1. **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥—Ä—É–≥–∏—Ö –º–æ–¥–µ–ª–µ–π**: Qwen2-VL-2B, Phi3-Vision
2. **–ù–∞—Å—Ç—Ä–æ–π–∫–∞ multi-model**: –ó–∞–ø—É—Å–∫ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –º–æ–¥–µ–ª–µ–π –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ
3. **–í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å**: Streamlit –∏–ª–∏ Gradio –¥–ª—è —É–¥–æ–±–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
4. **–ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ–Ω–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞**: Nginx –ø—Ä–æ–∫—Å–∏, –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

## ‚úÖ –ó–ê–ö–õ–Æ–ß–ï–ù–ò–ï

**DotsOCR —É—Å–ø–µ—à–Ω–æ –∑–∞–ø—É—â–µ–Ω–∞ —á–µ—Ä–µ–∑ Docker Compose —Å –ø–æ–ª–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å—é!**

–°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ–º—É –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –¥–ª—è OCR –∑–∞–¥–∞—á —Å:
- ‚ö° –í—ã—Å–æ–∫–æ–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å—é (0.4 —Å–µ–∫ –Ω–∞ –∑–∞–ø—Ä–æ—Å)
- üîß –ü—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –ø—Ä–∞–≤–∞–º–∏ –Ω–∞ –∑–∞–ø–∏—Å—å –≤ –∫–µ—à
- üìä –°—Ç–∞–±–∏–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç–æ–π –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–æ–º
- üê≥ –£–¥–æ–±–Ω—ã–º —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ–º —á–µ—Ä–µ–∑ Docker Compose

---
*–û—Ç—á–µ—Ç —Å–æ–∑–¥–∞–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã*