#!/usr/bin/env python3
"""
–ë—ã—Å—Ç—Ä—ã–π —Ç–µ—Å—Ç –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ –ø–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π vLLM
"""

def test_vllm_adapter_basic():
    """–ë–∞–∑–æ–≤—ã–π —Ç–µ—Å—Ç vLLM –∞–¥–∞–ø—Ç–µ—Ä–∞"""
    
    print("üîß –ë–´–°–¢–†–´–ô –¢–ï–°–¢ vLLM –ò–°–ü–†–ê–í–õ–ï–ù–ò–ô")
    print("=" * 40)
    
    try:
        # –¢–µ—Å—Ç 1: –ò–º–ø–æ—Ä—Ç –∞–¥–∞–ø—Ç–µ—Ä–∞
        print("1Ô∏è‚É£ –ò–º–ø–æ—Ä—Ç –∞–¥–∞–ø—Ç–µ—Ä–∞...")
        from vllm_streamlit_adapter import VLLMStreamlitAdapter
        print("   ‚úÖ –ê–¥–∞–ø—Ç–µ—Ä –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω")
        
        # –¢–µ—Å—Ç 2: –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        print("2Ô∏è‚É£ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è...")
        adapter = VLLMStreamlitAdapter()
        print("   ‚úÖ –ê–¥–∞–ø—Ç–µ—Ä –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω")
        
        # –¢–µ—Å—Ç 3: –ü–æ–ª—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π
        print("3Ô∏è‚É£ –ü–æ–ª—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π...")
        models = adapter.available_models
        
        if models:
            print(f"   ‚úÖ –ù–∞–π–¥–µ–Ω–æ –º–æ–¥–µ–ª–µ–π: {len(models)}")
            for model in models:
                print(f"   üìä –ú–æ–¥–µ–ª—å: {model}")
        else:
            print("   ‚ö†Ô∏è –ú–æ–¥–µ–ª–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã (–≤–æ–∑–º–æ–∂–Ω–æ, vLLM –Ω–µ –∑–∞–ø—É—â–µ–Ω)")
        
        # –¢–µ—Å—Ç 4: –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–∏–º–∏—Ç–æ–≤ —Ç–æ–∫–µ–Ω–æ–≤
        print("4Ô∏è‚É£ –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–∏–º–∏—Ç–æ–≤ —Ç–æ–∫–µ–Ω–æ–≤...")
        
        if hasattr(adapter, 'model_limits'):
            limits = adapter.model_limits
            if limits:
                print("   ‚úÖ –õ–∏–º–∏—Ç—ã —Ç–æ–∫–µ–Ω–æ–≤ –ø–æ–ª—É—á–µ–Ω—ã:")
                for model, limit in limits.items():
                    print(f"      ‚Ä¢ {model}: {limit} —Ç–æ–∫–µ–Ω–æ–≤")
            else:
                print("   ‚ö†Ô∏è –õ–∏–º–∏—Ç—ã —Ç–æ–∫–µ–Ω–æ–≤ –ø—É—Å—Ç—ã")
        else:
            print("   ‚ùå –ê—Ç—Ä–∏–±—É—Ç model_limits –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç")
        
        # –¢–µ—Å—Ç 5: –ú–µ—Ç–æ–¥ –ø–æ–ª—É—á–µ–Ω–∏—è –ª–∏–º–∏—Ç–∞
        print("5Ô∏è‚É£ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –º–µ—Ç–æ–¥–∞ get_model_max_tokens...")
        
        if models:
            test_model = models[0]
            limit = adapter.get_model_max_tokens(test_model)
            print(f"   ‚úÖ –õ–∏–º–∏—Ç –¥–ª—è {test_model}: {limit} —Ç–æ–∫–µ–Ω–æ–≤")
            
            # –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π –º–æ–¥–µ–ª–∏
            fake_limit = adapter.get_model_max_tokens("fake-model")
            print(f"   ‚úÖ –õ–∏–º–∏—Ç –¥–ª—è –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π –º–æ–¥–µ–ª–∏: {fake_limit} —Ç–æ–∫–µ–Ω–æ–≤ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)")
        
        print("\nüéâ –í–°–ï –ë–ê–ó–û–í–´–ï –¢–ï–°–¢–´ –ü–†–û–ô–î–ï–ù–´!")
        return True
        
    except Exception as e:
        print(f"\n‚ùå –û–®–ò–ë–ö–ê –í –¢–ï–°–¢–ï: {e}")
        return False

def main():
    """–ì–ª–∞–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è"""
    
    success = test_vllm_adapter_basic()
    
    if success:
        print("\n‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø –†–ê–ë–û–¢–ê–Æ–¢!")
        print("üí° –¢–µ–ø–µ—Ä—å –º–æ–∂–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å:")
        print("   streamlit run app.py")
        print("\nüìã –ß—Ç–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ:")
        print("   ‚Ä¢ –í—ã–±–µ—Ä–∏—Ç–µ 'vLLM (–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)' —Ä–µ–∂–∏–º")
        print("   ‚Ä¢ –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ dots.ocr")
        print("   ‚Ä¢ –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —É–≤–µ–ª–∏—á–∏—Ç—å —Ç–æ–∫–µ–Ω—ã - –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ")
        print("   ‚Ä¢ –¢–æ–∫–µ–Ω—ã –¥–æ–ª–∂–Ω—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞—Ç—å—Å—è –¥–æ 1024")
    else:
        print("\n‚ö†Ô∏è –¢–†–ï–ë–£–Æ–¢–°–Ø –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–´–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø")

if __name__ == "__main__":
    main()