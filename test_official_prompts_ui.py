#!/usr/bin/env python3
"""
–¢–µ—Å—Ç –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ —Å –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–º–∏ –ø—Ä–æ–º–ø—Ç–∞–º–∏ dots.ocr
–ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –∫–Ω–æ–ø–∫–∏ —Å –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–º–∏ –ø—Ä–æ–º–ø—Ç–∞–º–∏ —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
"""

import streamlit as st
from PIL import Image, ImageDraw, ImageFont
import time

def create_test_document():
    """–°–æ–∑–¥–∞–µ–º —Ç–µ—Å—Ç–æ–≤—ã–π –¥–æ–∫—É–º–µ–Ω—Ç –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏."""
    img = Image.new('RGB', (600, 400), color='white')
    draw = ImageDraw.Draw(img)
    
    try:
        font = ImageFont.truetype("arial.ttf", 16)
    except:
        font = ImageFont.load_default()
    
    # –ó–∞–≥–æ–ª–æ–≤–æ–∫
    draw.text((50, 30), "–¢–ï–°–¢–û–í–´–ô –î–û–ö–£–ú–ï–ù–¢", fill='black', font=font)
    draw.text((50, 60), "–°—á–µ—Ç ‚Ññ 12345 –æ—Ç 24.01.2026", fill='black', font=font)
    
    # –û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
    draw.text((50, 100), "–ü–æ—Å—Ç–∞–≤—â–∏–∫: –û–û–û '–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏'", fill='black', font=font)
    draw.text((50, 130), "–ü–æ–∫—É–ø–∞—Ç–µ–ª—å: –û–û–û '–ö–ª–∏–µ–Ω—Ç'", fill='black', font=font)
    
    # –ü—Ä–æ—Å—Ç–∞—è —Ç–∞–±–ª–∏—Ü–∞
    draw.rectangle([50, 170, 550, 270], outline='black', width=2)
    draw.line([50, 200, 550, 200], fill='black', width=1)
    draw.line([300, 170, 300, 270], fill='black', width=1)
    
    draw.text((60, 180), "–¢–æ–≤–∞—Ä", fill='black', font=font)
    draw.text((310, 180), "–¶–µ–Ω–∞", fill='black', font=font)
    draw.text((60, 210), "–ü—Ä–æ–≥—Ä–∞–º–º–Ω–æ–µ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏–µ", fill='black', font=font)
    draw.text((310, 210), "50,000 —Ä—É–±.", fill='black', font=font)
    draw.text((60, 240), "–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞", fill='black', font=font)
    draw.text((310, 240), "25,000 —Ä—É–±.", fill='black', font=font)
    
    # –ò—Ç–æ–≥–æ
    draw.text((50, 300), "–ò–¢–û–ì–û: 75,000 —Ä—É–±.", fill='black', font=font)
    draw.text((50, 330), "–ù–î–° 20%: 15,000 —Ä—É–±.", fill='black', font=font)
    draw.text((50, 360), "–í—Å–µ–≥–æ –∫ –æ–ø–ª–∞—Ç–µ: 90,000 —Ä—É–±.", fill='black', font=font)
    
    return img

def main():
    """–î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ —Å –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–º–∏ –ø—Ä–æ–º–ø—Ç–∞–º–∏."""
    st.set_page_config(
        page_title="–¢–µ—Å—Ç –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã—Ö –ø—Ä–æ–º–ø—Ç–æ–≤ dots.ocr",
        page_icon="üéØ",
        layout="wide"
    )
    
    st.title("üéØ –¢–µ—Å—Ç –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ —Å –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–º–∏ –ø—Ä–æ–º–ø—Ç–∞–º–∏ dots.ocr")
    
    st.markdown("""
    –≠—Ç–æ—Ç —Ç–µ—Å—Ç –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç –Ω–æ–≤—É—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ —á–∞—Ç–∞ —Å –∫–Ω–æ–ø–∫–∞–º–∏ 
    –¥–ª—è –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã—Ö –ø—Ä–æ–º–ø—Ç–æ–≤ dots.ocr.
    """)
    
    # –°–æ–∑–¥–∞–µ–º —Ç–µ—Å—Ç–æ–≤–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
    if st.button("üì∑ –°–æ–∑–¥–∞—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–π –¥–æ–∫—É–º–µ–Ω—Ç"):
        test_image = create_test_document()
        test_image.save("ui_test_document.png")
        st.success("‚úÖ –¢–µ—Å—Ç–æ–≤—ã–π –¥–æ–∫—É–º–µ–Ω—Ç —Å–æ–∑–¥–∞–Ω: ui_test_document.png")
        st.image(test_image, caption="–¢–µ—Å—Ç–æ–≤—ã–π –¥–æ–∫—É–º–µ–Ω—Ç", width=600)
    
    st.divider()
    
    # –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã—Ö –ø—Ä–æ–º–ø—Ç–æ–≤
    st.subheader("üéØ –û—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–µ –ø—Ä–æ–º–ø—Ç—ã dots.ocr")
    st.markdown("–≠—Ç–∏ –ø—Ä–æ–º–ø—Ç—ã –±—É–¥—É—Ç –¥–æ—Å—Ç—É–ø–Ω—ã –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ —á–∞—Ç–∞ –ø—Ä–∏ –≤—ã–±–æ—Ä–µ dots.ocr –º–æ–¥–µ–ª–∏:")
    
    official_prompts = {
        "üî§ –ü—Ä–æ—Å—Ç–æ–µ OCR": {
            "prompt": "Extract all text from this image.",
            "description": "–ò–∑–≤–ª–µ–∫–∞–µ—Ç –≤–µ—Å—å —Ç–µ–∫—Å—Ç –≤–∫–ª—é—á–∞—è —Ç–∞–±–ª–∏—Ü—ã –≤ HTML",
            "expected": "–ü–æ–ª–Ω—ã–π —Ç–µ–∫—Å—Ç –¥–æ–∫—É–º–µ–Ω—Ç–∞ —Å HTML —Ç–∞–±–ª–∏—Ü–µ–π"
        },
        "üìã –î–µ—Ç–∞–ª—å–Ω–æ–µ OCR": {
            "prompt": "Extract all text content from this image while maintaining reading order. Exclude headers and footers.",
            "description": "–î–µ—Ç–∞–ª—å–Ω–æ–µ –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ —Å –ø–æ—Ä—è–¥–∫–æ–º —á—Ç–µ–Ω–∏—è",
            "expected": "–¢–µ–∫—Å—Ç –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ –±–µ–∑ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤"
        },
        "üèóÔ∏è –ê–Ω–∞–ª–∏–∑ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã": {
            "prompt": "Extract text, layout, and structure from this document image. Include bounding boxes, categories, and format tables as HTML, formulas as LaTeX, and text as Markdown.",
            "description": "–ü–æ–ª–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –º–∞–∫–µ—Ç–∞ –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã",
            "expected": "–°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∞–Ω–∞–ª–∏–∑ —Å —Ä–∞–∑–º–µ—Ç–∫–æ–π"
        },
        "üìä –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü": {
            "prompt": "Extract and format the table content from this document as structured data.",
            "description": "–°–ø–µ—Ü–∏–∞–ª—å–Ω–æ –¥–ª—è —Ç–∞–±–ª–∏—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö",
            "expected": "HTML —Ç–∞–±–ª–∏—Ü–∞ —Å –¥–∞–Ω–Ω—ã–º–∏"
        },
        "üìÑ –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ": {
            "prompt": "Analyze this document and extract structured information including text, tables, and layout elements.",
            "description": "–ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –¥–æ–∫—É–º–µ–Ω—Ç–∞",
            "expected": "–ü–æ–ª–Ω—ã–π —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∞–Ω–∞–ª–∏–∑"
        }
    }
    
    for button_text, prompt_info in official_prompts.items():
        with st.expander(f"{button_text} - {prompt_info['description']}"):
            st.code(prompt_info["prompt"], language="text")
            st.info(f"**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:** {prompt_info['expected']}")
    
    st.divider()
    
    # –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –ø—Ä–∏–º–µ—Ä–æ–≤ –¥–ª—è –¥—Ä—É–≥–∏—Ö –º–æ–¥–µ–ª–µ–π
    st.subheader("üí¨ –ü—Ä–∏–º–µ—Ä—ã –≤–æ–ø—Ä–æ—Å–æ–≤ –¥–ª—è —á–∞—Ç-–º–æ–¥–µ–ª–µ–π")
    st.markdown("–≠—Ç–∏ –ø—Ä–∏–º–µ—Ä—ã –±—É–¥—É—Ç –¥–æ—Å—Ç—É–ø–Ω—ã –ø—Ä–∏ –≤—ã–±–æ—Ä–µ Qwen3-VL –∏–ª–∏ –¥—Ä—É–≥–∏—Ö —á–∞—Ç-–º–æ–¥–µ–ª–µ–π:")
    
    chat_examples = [
        "üîç –ß—Ç–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–æ –Ω–∞ –∫–∞—Ä—Ç–∏–Ω–∫–µ?",
        "üìù –û–ø–∏—à–∏ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞",
        "üî¢ –ù–∞–π–¥–∏ –≤—Å–µ —á–∏—Å–ª–∞ –≤ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–∏",
        "üìä –ï—Å—Ç—å –ª–∏ —Ç–∞–±–ª–∏—Ü—ã –≤ –¥–æ–∫—É–º–µ–Ω—Ç–µ?",
        "üèóÔ∏è –û–ø–∏—à–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–æ–∫—É–º–µ–Ω—Ç–∞"
    ]
    
    for example in chat_examples:
        st.button(example, disabled=True, help="–î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è - –∫–Ω–æ–ø–∫–∞ –Ω–µ–∞–∫—Ç–∏–≤–Ω–∞")
    
    st.divider()
    
    # –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é
    st.subheader("üìñ –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–æ–≤—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å")
    
    col1, col2 = st.columns(2)
    
    with col1:
        st.markdown("""
        **–î–ª—è dots.ocr –º–æ–¥–µ–ª–∏:**
        1. –í—ã–±–µ—Ä–∏—Ç–µ dots.ocr –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –º–æ–¥–µ–ª–∏
        2. –ó–∞–≥—Ä—É–∑–∏—Ç–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞
        3. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–Ω–æ–ø–∫–∏ —Å –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–º–∏ –ø—Ä–æ–º–ø—Ç–∞–º–∏
        4. –ü–æ–ª—É—á–∏—Ç–µ –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã OCR
        """)
    
    with col2:
        st.markdown("""
        **–î–ª—è —á–∞—Ç-–º–æ–¥–µ–ª–µ–π (Qwen3-VL):**
        1. –í—ã–±–µ—Ä–∏—Ç–µ Qwen3-VL –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –º–æ–¥–µ–ª–∏
        2. –ó–∞–≥—Ä—É–∑–∏—Ç–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
        3. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø—Ä–∏–º–µ—Ä—ã –≤–æ–ø—Ä–æ—Å–æ–≤ –∏–ª–∏ –≤–≤–µ–¥–∏—Ç–µ —Å–≤–æ–π
        4. –í–µ–¥–∏—Ç–µ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –¥–∏–∞–ª–æ–≥
        """)
    
    st.success("""
    ‚úÖ **–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –Ω–æ–≤–æ–≥–æ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞:**
    - –û—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–µ –ø—Ä–æ–º–ø—Ç—ã –¥–∞—é—Ç –ª—É—á—à–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å dots.ocr
    - –£–¥–æ–±–Ω—ã–µ –∫–Ω–æ–ø–∫–∏ –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞
    - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∞–¥–∞–ø—Ç–∞—Ü–∏—è –ø–æ–¥ –≤—ã–±—Ä–∞–Ω–Ω—É—é –º–æ–¥–µ–ª—å
    - –ü–æ–¥—Å–∫–∞–∑–∫–∏ –∏ –ø—Ä–∏–º–µ—Ä—ã –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
    """)
    
    st.info("""
    üí° **–°–æ–≤–µ—Ç:** –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–µ –ø—Ä–æ–º–ø—Ç—ã —Å dots.ocr –¥–ª—è OCR –∑–∞–¥–∞—á, 
    –∏ —Å–≤–æ–±–æ–¥–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã —Å Qwen3-VL –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –∏ —á–∞—Ç–∞ –æ–± –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è—Ö.
    """)

if __name__ == "__main__":
    main()