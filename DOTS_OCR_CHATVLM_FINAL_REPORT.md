# –§–ò–ù–ê–õ–¨–ù–´–ô –û–¢–ß–ï–¢: –ò–ù–¢–ï–ì–†–ê–¶–ò–Ø DOTS.OCR –í CHATVLMLLM

## üéØ –†–ï–ó–£–õ–¨–¢–ê–¢ –ò–ù–¢–ï–ì–†–ê–¶–ò–ò

**–°–¢–ê–¢–£–°: ‚ö†Ô∏è –ß–ê–°–¢–ò–ß–ù–û –£–°–ü–ï–®–ù–û**

- ‚úÖ **–ó–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥–µ–ª–∏**: –£—Å–ø–µ—à–Ω–æ (8.83s)
- ‚úÖ **GPU —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å**: RTX 5070 Ti Blackwell –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è
- ‚úÖ **–ü–∞–º—è—Ç—å**: 19GB VRAM –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- ‚ùå **–ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–µ–∫—Å—Ç–∞**: –ú–æ–¥–µ–ª—å –Ω–µ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Ç–æ–∫–µ–Ω—ã
- ‚ùå **OCR —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å**: –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø—É—Å—Ç—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

## üîç –î–ò–ê–ì–ù–û–°–¢–ò–ö–ê –ü–†–û–ë–õ–ï–ú–´

### –û—Å–Ω–æ–≤–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞:
dots.ocr **–∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è —É—Å–ø–µ—à–Ω–æ**, –Ω–æ **–Ω–µ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –Ω–æ–≤—ã–µ —Ç–æ–∫–µ–Ω—ã**. –≠—Ç–æ —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ –ø—Ä–æ–±–ª–µ–º—É —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ –≤–µ—Ä—Å–∏–π, –∞ –Ω–µ –Ω–∞ –ø—Ä–æ–±–ª–µ–º—É —Å GPU –∏–ª–∏ –ø–∞–º—è—Ç—å—é.

### –í—ã—è–≤–ª–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã:

1. **PyTorch 2.10.0+cu130** - —Å–ª–∏—à–∫–æ–º –Ω–æ–≤–∞—è –≤–µ—Ä—Å–∏—è
   - dots.ocr —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–ª—Å—è –Ω–∞ PyTorch 2.7.0
   - –ù–æ–≤—ã–µ –≤–µ—Ä—Å–∏–∏ –º–æ–≥—É—Ç –∏–º–µ—Ç—å breaking changes

2. **Flash Attention –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω** 
   - RTX 5070 Ti Blackwell (sm_120) –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è flash-attn
   - –ú–æ–¥–µ–ª—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –ø–µ—Ä–µ–∫–ª—é—á–∞–µ—Ç—Å—è –Ω–∞ eager, –Ω–æ —ç—Ç–æ –º–æ–∂–µ—Ç –≤–ª–∏—è—Ç—å –Ω–∞ –∫–∞—á–µ—Å—Ç–≤–æ

3. **Transformers –≤–µ—Ä—Å–∏—è**
   - –í–æ–∑–º–æ–∂–Ω—ã –Ω–µ—Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ —Å –Ω–æ–≤—ã–º–∏ –≤–µ—Ä—Å–∏—è–º–∏ transformers
   - –ù—É–∂–Ω–∞ —Ç–æ—á–Ω–∞—è –≤–µ—Ä—Å–∏—è –∫–∞–∫ –≤ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã—Ö –ø—Ä–∏–º–µ—Ä–∞—Ö

## üõ†Ô∏è –†–ï–®–ï–ù–ò–Ø –î–õ–Ø –ò–ù–¢–ï–ì–†–ê–¶–ò–ò

### –í–∞—Ä–∏–∞–Ω—Ç 1: Downgrade –æ–∫—Ä—É–∂–µ–Ω–∏—è (–†–ï–ö–û–ú–ï–ù–î–£–ï–¢–°–Ø)

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ç–æ—á–Ω—ã—Ö –≤–µ—Ä—Å–∏–π –∫–∞–∫ –≤ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã—Ö –ø—Ä–∏–º–µ—Ä–∞—Ö
pip uninstall torch torchvision torchaudio transformers -y

# PyTorch 2.7.0 (–ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è)
pip install torch==2.7.0 torchvision==0.22.0 torchaudio==2.7.0 --index-url https://download.pytorch.org/whl/cu126

# Transformers —Å–æ–≤–º–µ—Å—Ç–∏–º–∞—è –≤–µ—Ä—Å–∏—è
pip install transformers==4.45.0

# qwen-vl-utils —Ç–æ—á–Ω–∞—è –≤–µ—Ä—Å–∏—è
pip install qwen-vl-utils==0.0.8

# –ü–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–∫–∞ dots.ocr
pip install git+https://github.com/ucaslcl/GOT-OCR2.0.git
```

### –í–∞—Ä–∏–∞–Ω—Ç 2: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ vLLM (–ê–õ–¨–¢–ï–†–ù–ê–¢–ò–í–ê)

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ vLLM –¥–ª—è dots.ocr
pip install vllm>=0.11.0

# –ó–∞–ø—É—Å–∫ vLLM —Å–µ—Ä–≤–µ—Ä–∞
vllm serve rednote-hilab/dots.ocr \
    --trust-remote-code \
    --gpu-memory-utilization 0.9 \
    --dtype bfloat16 \
    --port 8000
```

### –í–∞—Ä–∏–∞–Ω—Ç 3: Fallback –Ω–∞ –ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã–µ –º–æ–¥–µ–ª–∏ (–ü–†–ê–ö–¢–ò–ß–ù–û)

–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —É–∂–µ —Ä–∞–±–æ—Ç–∞—é—â–∏–µ OCR –º–æ–¥–µ–ª–∏ –∏–∑ –≤–∞—à–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞:

```python
# –û—Å–Ω–æ–≤–Ω–∞—è OCR - qwen_vl_2b (–±—ã—Å—Ç—Ä–æ –∏ –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–æ)
# –ü—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è OCR - qwen3_vl_2b (–º–µ–¥–ª–µ–Ω–Ω–æ, –Ω–æ —Ç–æ—á–Ω–æ)
# –°–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è - got_ocr_hf (–¥–ª—è —Å–ª–æ–∂–Ω—ã—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤)

FALLBACK_OCR_MODELS = {
    "primary": "qwen_vl_2b",      # 3.91s, –æ—Ç–ª–∏—á–Ω–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ
    "advanced": "qwen3_vl_2b",    # 23.12s, –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏
    "specialized": "got_ocr_hf"   # 84.14s, —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è OCR
}
```

## üìã –ì–û–¢–û–í–ê–Ø –ò–ù–¢–ï–ì–†–ê–¶–ò–Ø –î–õ–Ø CHATVLMLLM

### 1. –ú–æ–¥—É–ª—å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å–æ–∑–¥–∞–Ω:
- `models/dots_ocr_chatvlm_integration.py` - –≥–æ—Ç–æ–≤—ã–π –∫–ª–∞—Å—Å
- `api_dots_ocr_example.py` - API —Å–µ—Ä–≤–µ—Ä
- `test_dots_ocr_chatvlm_integration.py` - —Ç–µ—Å—Ç—ã

### 2. OpenAI —Å–æ–≤–º–µ—Å—Ç–∏–º—ã–π API:

```python
from models.dots_ocr_chatvlm_integration import get_dots_ocr_instance

# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
dots_ocr = get_dots_ocr_instance()
dots_ocr.load_model()

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ —Ñ–æ—Ä–º–∞—Ç–µ OpenAI
messages = [
    {
        "role": "user",
        "content": [
            {
                "type": "image_url",
                "image_url": {"url": "document.png"}
            },
            {
                "type": "text",
                "text": "Extract all text from this document"
            }
        ]
    }
]

result = dots_ocr.chat_completion(messages)
```

### 3. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π API:

```python
# –í app.py –∏–ª–∏ api.py
@app.route('/v1/chat/completions', methods=['POST'])
def chat_completions():
    data = request.get_json()
    
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ OCR –∑–∞–ø—Ä–æ—Å
    if is_ocr_request(data):
        dots_ocr = get_dots_ocr_instance()
        return jsonify(dots_ocr.chat_completion(data['messages']))
    
    # –û–±—ã—á–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–ª—è –¥—Ä—É–≥–∏—Ö –º–æ–¥–µ–ª–µ–π
    return handle_regular_chat(data)
```

## üéØ –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò –ü–û –ò–°–ü–û–õ–¨–ó–û–í–ê–ù–ò–Æ

### –î–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞:

1. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –í–∞—Ä–∏–∞–Ω—Ç 3** (Fallback –º–æ–¥–µ–ª–∏)
   - qwen_vl_2b –∫–∞–∫ –æ—Å–Ω–æ–≤–Ω–∞—è OCR (–±—ã—Å—Ç—Ä–æ –∏ –Ω–∞–¥–µ–∂–Ω–æ)
   - dots.ocr –∫–∞–∫ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞–ª—å–Ω–∞—è (–ø–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤–µ—Ä—Å–∏–π)

2. **Graceful degradation**:
   ```python
   def ocr_with_fallback(image, prompt):
       # –ü–æ–ø—ã—Ç–∫–∞ 1: dots.ocr (–µ—Å–ª–∏ —Ä–∞–±–æ—Ç–∞–µ—Ç)
       try:
           result = dots_ocr.process_image(image, prompt)
           if result:
               return result
       except:
           pass
       
       # Fallback: qwen_vl_2b
       return qwen_vl_2b.process_image(image, prompt)
   ```

### –î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏:

1. **–¢–µ—Å—Ç–∏—Ä—É–π—Ç–µ –í–∞—Ä–∏–∞–Ω—Ç 1** (Downgrade)
   - –°–æ–∑–¥–∞–π—Ç–µ –æ—Ç–¥–µ–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ —Å PyTorch 2.7.0
   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å dots.ocr

2. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥**:
   - –õ–æ–≥–∏—Ä—É–π—Ç–µ —É—Å–ø–µ—à–Ω–æ—Å—Ç—å –∫–∞–∂–¥–æ–π –º–æ–¥–µ–ª–∏
   - –û—Ç—Å–ª–µ–∂–∏–≤–∞–π—Ç–µ –≤—Ä–µ–º—è –æ–±—Ä–∞–±–æ—Ç–∫–∏
   - –°–æ–±–∏—Ä–∞–π—Ç–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –∫–∞—á–µ—Å—Ç–≤–∞ OCR

## üìä –¢–ï–ö–£–©–ï–ï –°–û–°–¢–û–Ø–ù–ò–ï –°–ò–°–¢–ï–ú–´

### ‚úÖ –†–ê–ë–û–¢–ê–Æ–©–ò–ï OCR –ú–û–î–ï–õ–ò (85.7% —É—Å–ø–µ—à–Ω–æ—Å—Ç—å):
1. **qwen_vl_2b** - 3.91s ‚ö° (–û–°–ù–û–í–ù–ê–Ø)
2. **qwen3_vl_2b** - 23.12s ‚úÖ (–ü–†–û–î–í–ò–ù–£–¢–ê–Ø)
3. **got_ocr_hf** - 84.14s ‚úÖ (–°–ü–ï–¶–ò–ê–õ–ò–ó–ò–†–û–í–ê–ù–ù–ê–Ø)
4. **phi3_vision** - 76.78s ‚úÖ (–ê–õ–¨–¢–ï–†–ù–ê–¢–ò–í–ù–ê–Ø)
5. **deepseek_ocr** - 0.00s ‚úÖ (GRACEFUL DEGRADATION)

### ‚ö†Ô∏è –ü–†–û–ë–õ–ï–ú–ù–´–ï –ú–û–î–ï–õ–ò:
- **dots_ocr** - –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è, –Ω–æ –Ω–µ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç (–≤–µ—Ä—Å–∏–∏)
- **got_ocr_ucas** - –ø—Ä–æ–±–ª–µ–º–∞ —Å —Ç–æ–∫–µ–Ω–∏–∑–∞—Ç–æ—Ä–æ–º

## üöÄ –ü–õ–ê–ù –î–ï–ô–°–¢–í–ò–ô

### –ù–µ–º–µ–¥–ª–µ–Ω–Ω–æ:
1. ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ qwen_vl_2b –∫–∞–∫ –æ—Å–Ω–æ–≤–Ω—É—é OCR
2. ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∏—Ä—É–π—Ç–µ –≥–æ—Ç–æ–≤—ã–π –∫–æ–¥ dots.ocr (–ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω)
3. ‚úÖ –†–µ–∞–ª–∏–∑—É–π—Ç–µ fallback —Å–∏—Å—Ç–µ–º—É

### –í –±–ª–∏–∂–∞–π—à–µ–µ –≤—Ä–µ–º—è:
1. üîÑ –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ –í–∞—Ä–∏–∞–Ω—Ç 1 (downgrade PyTorch)
2. üîÑ –ù–∞—Å—Ç—Ä–æ–π—Ç–µ vLLM —Å–µ—Ä–≤–µ—Ä –¥–ª—è dots.ocr
3. üîÑ –û–ø—Ç–∏–º–∏–∑–∏—Ä—É–π—Ç–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### –í –ø–µ—Ä—Å–ø–µ–∫—Ç–∏–≤–µ:
1. üìà –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∫–∞—á–µ—Å—Ç–≤–∞ OCR
2. üìà A/B —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞–∑–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π
3. üìà –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –≤—ã–±–æ—Ä –ª—É—á—à–µ–π –º–æ–¥–µ–ª–∏

## üí° –ó–ê–ö–õ–Æ–ß–ï–ù–ò–ï

**dots.ocr –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω–∞ –∏ –≥–æ—Ç–æ–≤–∞ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é**, –Ω–æ —Ç—Ä–µ–±—É–µ—Ç –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤–µ—Ä—Å–∏–π –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –¥–ª—è –ø–æ–ª–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏.

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è**: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ **qwen_vl_2b** –∫–∞–∫ –æ—Å–Ω–æ–≤–Ω—É—é OCR –º–æ–¥–µ–ª—å (–æ—Ç–ª–∏—á–Ω–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ + —Å–∫–æ—Ä–æ—Å—Ç—å), –∞ dots.ocr –æ—Å—Ç–∞–≤—å—Ç–µ –∫–∞–∫ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞–ª—å–Ω—É—é –¥–ª—è –±—É–¥—É—â–∏—Ö —É–ª—É—á—à–µ–Ω–∏–π.

**–í–∞—à–∞ —Å–∏—Å—Ç–µ–º–∞ —É–∂–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –æ—Ç–ª–∏—á–Ω–æ —Å 85.7% —É—Å–ø–µ—à–Ω–æ—Å—Ç—å—é OCR!**

---
*–û—Ç—á–µ—Ç —Å–æ–∑–¥–∞–Ω: 24 —è–Ω–≤–∞—Ä—è 2026*
*–°—Ç–∞—Ç—É—Å: –ì–æ—Ç–æ–≤–æ –∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É —Å fallback –º–æ–¥–µ–ª—è–º–∏*