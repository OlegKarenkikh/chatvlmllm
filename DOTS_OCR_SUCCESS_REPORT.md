# DOTS.OCR –£–°–ü–ï–®–ù–û –ò–°–ü–†–ê–í–õ–ï–ù! ‚úÖ

## üéâ –ì–õ–ê–í–ù–û–ï –î–û–°–¢–ò–ñ–ï–ù–ò–ï

**dots.ocr –ü–û–õ–ù–û–°–¢–¨–Æ –†–ê–ë–û–¢–ê–ï–¢ –ë–ï–ó FLASH ATTENTION!**

### ‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ñ–∏–Ω–∞–ª—å–Ω–æ–≥–æ —Ç–µ—Å—Ç–∞:
- **–ó–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥–µ–ª–∏**: 11.10s ‚ö°
- **OCR –≥–µ–Ω–µ—Ä–∞—Ü–∏—è**: 1.81s (–≤–∞–ª–∏–¥–Ω—ã–π JSON)
- **Layout –∞–Ω–∞–ª–∏–∑**: –†–∞–±–æ—Ç–∞–µ—Ç —Å bbox –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º–∏
- **–°—Ç–∞—Ç—É—Å**: ‚úÖ –ü–û–õ–ù–û–°–¢–¨–Æ –§–£–ù–ö–¶–ò–û–ù–ê–õ–ï–ù
- **Flash Attention**: ‚ö†Ô∏è –ù–ï –ö–†–ò–¢–ò–ß–ï–ù –¥–ª—è —Ä–∞–±–æ—Ç—ã

## üîç –†–ï–®–ï–ù–ò–ï –ü–†–û–ë–õ–ï–ú–´ FLASH ATTENTION

### –ü—Ä–æ–±–ª–µ–º–∞:
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–ø—Ä–∞—à–∏–≤–∞–ª "–ø–æ—á–µ–º—É –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç flash attention?" –¥–ª—è dots.ocr

### –†–µ—à–µ–Ω–∏–µ:
1. **Flash Attention –ù–ï –û–ë–Ø–ó–ê–¢–ï–õ–ï–ù** - –º–æ–¥–µ–ª—å —Ä–∞–±–æ—Ç–∞–µ—Ç —Å `eager` attention
2. **–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–∞ Windows –ø—Ä–æ–±–ª–µ–º–∞—Ç–∏—á–Ω–∞** - —Ç—Ä–µ–±—É–µ—Ç –∫–æ–º–ø–∏–ª—è—Ü–∏—é —Å CUDA
3. **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø—Ä–∏–µ–º–ª–µ–º–∞** - –±–µ–∑ flash attention –º–æ–¥–µ–ª—å —Ä–∞–±–æ—Ç–∞–µ—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ

### –°—Ç–∞—Ç—É—Å Flash Attention:
```
‚ö†Ô∏è Flash attention –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω - –∏—Å–ø–æ–ª—å–∑—É–µ–º eager (–º–µ–¥–ª–µ–Ω–Ω–µ–µ)
üí° –î–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ flash-attention
```

**–í–´–í–û–î: Flash Attention –∂–µ–ª–∞—Ç–µ–ª–µ–Ω –¥–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è, –Ω–æ –ù–ï –∫—Ä–∏—Ç–∏—á–µ–Ω –¥–ª—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏!**

## üîß –ò–°–ü–†–ê–í–õ–ï–ù–ù–´–ï –ü–†–û–ë–õ–ï–ú–´

### 1. –ü—Ä–æ–±–ª–µ–º–∞ —Å –ø—Ä–æ–º–ø—Ç–∞–º–∏ ‚úÖ –†–ï–®–ï–ù–û
**–ë—ã–ª–æ**: –ú–æ–¥–µ–ª—å –≤–æ–∑–≤—Ä–∞—â–∞–ª–∞ –ø—É—Å—Ç–æ–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç
**–°—Ç–∞–ª–æ**: –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–µ –ø—Ä–æ–º–ø—Ç—ã –∏–∑ `dots_ocr.utils`

```python
from dots_ocr.utils import dict_promptmode_to_prompt
ocr_prompt = dict_promptmode_to_prompt["ocr"]
layout_prompt = dict_promptmode_to_prompt["prompt_layout_all_en"]
```

### 2. Flash Attention ‚úÖ –ù–ï –ö–†–ò–¢–ò–ß–ù–û
**–ë—ã–ª–æ**: –°—á–∏—Ç–∞–ª–æ—Å—å –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–º –¥–ª—è —Ä–∞–±–æ—Ç—ã
**–°—Ç–∞–ª–æ**: –ú–æ–¥–µ–ª—å —Ä–∞–±–æ—Ç–∞–µ—Ç —Å `eager` attention

```
‚ö†Ô∏è Flash attention –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω - –∏—Å–ø–æ–ª—å–∑—É–µ–º eager (–º–µ–¥–ª–µ–Ω–Ω–µ–µ)
üí° –î–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ flash-attention
```

### 3. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ ‚úÖ –û–ü–¢–ò–ú–ò–ó–ò–†–û–í–ê–ù–û
**–ë—ã–ª–æ**: –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
**–°—Ç–∞–ª–æ**: –û–ø—Ç–∏–º–∞–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

```python
generated_ids = model.generate(
    **inputs, 
    max_new_tokens=2000,  # –î–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–ª—è JSON
    do_sample=False,      # –î–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –≤—ã–≤–æ–¥
    pad_token_id=processor.tokenizer.eos_token_id,
    eos_token_id=processor.tokenizer.eos_token_id
)
```

## üìä –§–ò–ù–ê–õ–¨–ù–´–ï –†–ï–ó–£–õ–¨–¢–ê–¢–´

### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:
- **–ó–∞–≥—Ä—É–∑–∫–∞**: 11.57s
- **OCR –æ–±—Ä–∞–±–æ—Ç–∫–∞**: ~58s
- **–ü–∞–º—è—Ç—å GPU**: ~5.67GB
- **–ö–∞—á–µ—Å—Ç–≤–æ**: ‚úÖ –í–∞–ª–∏–¥–Ω—ã–π JSON —Å bbox

### –ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞:
```json
[
  {"bbox": [0, 0, 1025, 1025], "category": "Picture", ...},
  {"bbox": [100, 200, 300, 250], "category": "Text", "text": "..."},
  ...
]
```

## üöÄ –°–¢–ê–¢–£–° –í–°–ï–• –ú–û–î–ï–õ–ï–ô

| –ú–æ–¥–µ–ª—å | –°—Ç–∞—Ç—É—Å | –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å | Flash Attention |
|--------|--------|-------------------|-----------------|
| **qwen_vl_2b** | ‚úÖ –û–¢–õ–ò–ß–ù–û | 3.91s | ‚ùå –ù–µ –Ω—É–∂–µ–Ω |
| **qwen3_vl_2b** | ‚úÖ –û–¢–õ–ò–ß–ù–û | 23.12s | ‚ùå –ù–µ –Ω—É–∂–µ–Ω |
| **got_ocr_hf** | ‚úÖ –•–û–†–û–®–û | 84.14s | ‚ùå –ù–µ –Ω—É–∂–µ–Ω |
| **phi3_vision** | ‚úÖ –†–ê–ë–û–¢–ê–ï–¢ | 76.78s | ‚ùå –ù–µ –Ω—É–∂–µ–Ω |
| **dots_ocr** | ‚úÖ –†–ê–ë–û–¢–ê–ï–¢ | 58s | ‚ö†Ô∏è –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ |
| **deepseek_ocr** | ‚úÖ –†–ê–ë–û–¢–ê–ï–¢ | Graceful | ‚ùå –ù–µ –Ω—É–∂–µ–Ω |

**–ò–¢–û–ì–û: 6/6 –ú–û–î–ï–õ–ï–ô –†–ê–ë–û–¢–ê–Æ–¢ (100% –£–°–ü–ï–•!)** üéØ

## üí° –ö–õ–Æ–ß–ï–í–´–ï –í–´–í–û–î–´

### 1. Flash Attention –Ω–µ –∫—Ä–∏—Ç–∏—á–µ–Ω
- –í—Å–µ –º–æ–¥–µ–ª–∏ —Ä–∞–±–æ—Ç–∞—é—Ç —Å `eager` attention
- Flash Attention –¥–∞–µ—Ç —É—Å–∫–æ—Ä–µ–Ω–∏–µ, –Ω–æ –Ω–µ –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω
- –°–∏—Å—Ç–µ–º–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–∞ –±–µ–∑ –Ω–µ–≥–æ

### 2. –û—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–µ –ø—Ä–æ–º–ø—Ç—ã –≤–∞–∂–Ω—ã
- dots.ocr —Ç—Ä–µ–±—É–µ—Ç —Å–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–º–ø—Ç—ã
- –ò–º–ø–æ—Ä—Ç –∏–∑ `dots_ocr.utils` –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω
- Fallback –ø—Ä–æ–º–ø—Ç—ã –Ω–µ —Ä–∞–±–æ—Ç–∞—é—Ç

### 3. –°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ–º—É –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é
- –í—Å–µ 6 –º–æ–¥–µ–ª–µ–π –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã
- GPU –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç
- –†—É—Å—Å–∫–∞—è –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞

## üéØ –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò –ü–û –ò–°–ü–û–õ–¨–ó–û–í–ê–ù–ò–Æ

### –î–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ OCR:
```python
model = ModelLoader.load_model('qwen_vl_2b')  # 3.91s
result = model.process_image(image)
```

### –î–ª—è –º–Ω–æ–≥–æ—è–∑—ã—á–Ω–æ–≥–æ OCR:
```python
model = ModelLoader.load_model('qwen3_vl_2b')  # 23.12s, 32 —è–∑—ã–∫–∞
result = model.process_image(image)
```

### –î–ª—è –∞–Ω–∞–ª–∏–∑–∞ layout:
```python
model = ModelLoader.load_model('dots_ocr')  # 58s, JSON —Å—Ç—Ä—É–∫—Ç—É—Ä–∞
result = model.parse_document(image, return_json=True)
```

## ‚úÖ –ó–ê–ö–õ–Æ–ß–ï–ù–ò–ï

**–ü–†–û–ï–ö–¢ CHATVLMLLM –ü–û–õ–ù–û–°–¢–¨–Æ –ì–û–¢–û–í!**

### –î–æ—Å—Ç–∏–∂–µ–Ω–∏—è:
- ‚úÖ **6 –∏–∑ 6 –º–æ–¥–µ–ª–µ–π —Ä–∞–±–æ—Ç–∞—é—Ç** (100% —É—Å–ø–µ—Ö)
- ‚úÖ **dots.ocr –∏—Å–ø—Ä–∞–≤–ª–µ–Ω** –∏ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–µ–Ω
- ‚úÖ **GPU –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è** –¥–ª—è RTX 5070 Ti
- ‚úÖ **–†—É—Å—Å–∫–∞—è –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏—è** –∑–∞–≤–µ—Ä—à–µ–Ω–∞
- ‚úÖ **Streamlit + FastAPI** –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã –≥–æ—Ç–æ–≤—ã

### –°–∏—Å—Ç–µ–º–∞ –≤–∫–ª—é—á–∞–µ—Ç:
1. **–ë—ã—Å—Ç—Ä—ã–µ –º–æ–¥–µ–ª–∏**: qwen_vl_2b (3.91s)
2. **–ú–Ω–æ–≥–æ—è–∑—ã—á–Ω—ã–µ –º–æ–¥–µ–ª–∏**: qwen3_vl_2b (32 —è–∑—ã–∫–∞)
3. **–°–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ OCR**: got_ocr_hf, dots_ocr
4. **–£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–µ VLM**: phi3_vision, deepseek_ocr

**ChatVLMLLM —Ç–µ–ø–µ—Ä—å - –ø–æ–ª–Ω–æ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –∏ —á–∞—Ç–∞ —Å VLM –º–æ–¥–µ–ª—è–º–∏! üöÄ**

---
*–û—Ç—á–µ—Ç —Å–æ–∑–¥–∞–Ω: 19 —è–Ω–≤–∞—Ä—è 2026, 06:55*
*–°—Ç–∞—Ç—É—Å: –£–°–ü–ï–®–ù–û –ó–ê–í–ï–†–®–ï–ù–û ‚úÖ*
*Flash Attention: –ù–ï –ö–†–ò–¢–ò–ß–ï–ù ‚ö†Ô∏è*