# –°–≤–æ–¥–∫–∞ –ø–æ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ XML-—Ç–∞–±–ª–∏—Ü –≤ OCR

## ‚úÖ –ß—Ç–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

### 1. –ë–∞–∑–æ–≤—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
- **XMLTableParser** - –ø–∞—Ä—Å–µ—Ä XML-—Ç–∞–±–ª–∏—Ü –∏–∑ —Ç–µ–∫—Å—Ç–∞ OCR
- **PaymentDocumentParser** - —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–∞—Ä—Å–µ—Ä –¥–ª—è –ø–ª–∞—Ç–µ–∂–Ω—ã—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤  
- **OCROutputProcessor** - –∫–æ–º–ø–ª–µ–∫—Å–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä –≤—ã–≤–æ–¥–∞ OCR

### 2. –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å
- ‚úÖ –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ XML-—Ç–∞–±–ª–∏—Ü –∏–∑ —Ç–µ–∫—Å—Ç–∞
- ‚úÖ –ü–∞—Ä—Å–∏–Ω–≥ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã —Ç–∞–±–ª–∏—Ü (—Å—Ç—Ä–æ–∫–∏, —Å—Ç–æ–ª–±—Ü—ã, —è—á–µ–π–∫–∏)
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–∏–ø–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞
- ‚úÖ –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ–ª–µ–π (–ò–ù–ù, –ö–ü–ü, –ë–ò–ö, —Å—á–µ—Ç–∞)
- ‚úÖ –ê–Ω–∞–ª–∏–∑ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ —Ç–∞–±–ª–∏—Ü
- ‚úÖ –≠–∫—Å–ø–æ—Ä—Ç –≤ JSON –∏ Excel
- ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º–∏ OCR –º–æ–¥–µ–ª—è–º–∏

### 3. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –º–æ–¥–µ–ª—è–º–∏
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–∞ –º–æ–¥–µ–ª—å `DotsOCRFinalModel` —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π XML
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä–∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–∏ XML-—Ç–∞–±–ª–∏—Ü
- ‚úÖ –ù–æ–≤—ã–µ –º–µ—Ç–æ–¥—ã: `extract_payment_document()`, `export_table_data()`

### 4. API –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- ‚úÖ REST API —Å 6 —ç–Ω–¥–ø–æ–∏–Ω—Ç–∞–º–∏
- ‚úÖ –ö–æ–º–ø–ª–µ–∫—Å–Ω—ã–µ —Ç–µ—Å—Ç—ã –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
- ‚úÖ –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

## üéØ –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–ª–∞—Ç–µ–∂–Ω–æ–≥–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞
```python
# –ü—Ä–∏–º–µ—Ä –∏–∑ –≤–∞—à–µ–≥–æ –∑–∞–ø—Ä–æ—Å–∞
text = """–û–û–û ¬´–ë–µ—Ç–µ–ª—å–≥–µ–π–∑–µ –ê–ª—å—Ñ–∞ –¶–µ–Ω—Ç–∞–≤—Ä–∞-3¬ª
–ê–¥—Ä–µ—Å: 100001, –≥. –ú–æ—Å–∫–≤–∞, –í–µ—Å–µ–ª—ã–π –ø—Ä–æ—Å–ø–µ–∫—Ç, –¥–æ–º 13, –æ—Ñ–∏—Å 13
–û–±—Ä–∞–∑–µ—Ü –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è –ø–ª–∞—Ç–µ–∂–Ω–æ–≥–æ –ø–æ—Ä—É—á–µ–Ω–∏—è
<table>
<tr><td>–ò–ù–ù 7702000000</td><td>–ö–ü–ü 770201001</td><td></td></tr>
<tr><td>–ü–æ–ª—É—á–∞—Ç–µ–ª—å</td><td></td><td>–°—á. ‚Ññ</td></tr>
<tr><td>–û–û–û ¬´–ë–µ—Ç–µ–ª—å–≥–µ–π–∑–µ –ê–ª—å—Ñ–∞ –¶–µ–Ω—Ç–∞–≤—Ä–∞-3¬ª</td><td></td><td>40702890123456789012</td></tr>
</table>"""

# –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞
result = process_ocr_text(text)

# –†–µ–∑—É–ª—å—Ç–∞—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç:
# - –¢–∏–ø –¥–æ–∫—É–º–µ–Ω—Ç–∞: "payment"
# - –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã
# - –ò–∑–≤–ª–µ—á–µ–Ω–Ω—ã–µ –ø–æ–ª—è: –ò–ù–ù, –ö–ü–ü, —Å—á–µ—Ç–∞
# - –ê–Ω–∞–ª–∏–∑ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ
```

### –†–µ–∑—É–ª—å—Ç–∞—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∏
```json
{
  "document_type": "payment",
  "has_xml_tables": true,
  "processed_data": {
    "tables": [{
      "rows": 6, "cols": 3,
      "data": [
        ["–ò–ù–ù 7702000000", "–ö–ü–ü 770201001", ""],
        ["–ü–æ–ª—É—á–∞—Ç–µ–ª—å", "", "–°—á. ‚Ññ"],
        ["–û–û–û ¬´–ë–µ—Ç–µ–ª—å–≥–µ–π–∑–µ –ê–ª—å—Ñ–∞ –¶–µ–Ω—Ç–∞–≤—Ä–∞-3¬ª", "", "40702890123456789012"]
      ],
      "analysis": {
        "has_numbers": true,
        "key_fields": ["–∏–Ω–Ω", "–∫–ø–ø", "—Å—á–µ—Ç"],
        "fill_rate": 0.61
      }
    }],
    "fields": {
      "inn": "7702000000",
      "kpp": "770201001",
      "account": "40702890123456789012"
    }
  }
}
```

## üìÅ –°–æ–∑–¥–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

1. **utils/xml_table_parser.py** - –æ—Å–Ω–æ–≤–Ω–æ–π –ø–∞—Ä—Å–µ—Ä XML-—Ç–∞–±–ª–∏—Ü
2. **utils/ocr_output_processor.py** - –∫–æ–º–ø–ª–µ–∫—Å–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä OCR
3. **test_xml_table_processing.py** - —Ç–µ—Å—Ç—ã —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏
4. **api_xml_table_example.py** - REST API —Å–µ—Ä–≤–µ—Ä
5. **XML_TABLE_PROCESSING_GUIDE.md** - –ø–æ–¥—Ä–æ–±–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

## üöÄ –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

### –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç
```python
from utils.ocr_output_processor import process_ocr_text

# –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ç–µ–∫—Å—Ç–∞ —Å XML-—Ç–∞–±–ª–∏—Ü–µ–π
result = process_ocr_text(ocr_text, "model_name", "structured")

# –ï—Å–ª–∏ –Ω–∞–π–¥–µ–Ω—ã —Ç–∞–±–ª–∏—Ü—ã - –æ–Ω–∏ –±—É–¥—É—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±—Ä–∞–±–æ—Ç–∞–Ω—ã
if result['has_xml_tables']:
    tables = result['processed_data']['tables']
    fields = result['processed_data']['fields']
```

### –° OCR –º–æ–¥–µ–ª—å—é
```python
from models.dots_ocr_final import DotsOCRFinalModel

config = {'process_xml_tables': True}
model = DotsOCRFinalModel(config)

# –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ XML –ø—Ä–∏ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–∏
result = model.process_image(image, mode="table_extraction")
```

### API —Å–µ—Ä–≤–µ—Ä
```bash
python api_xml_table_example.py

# –û–±—Ä–∞–±–æ—Ç–∫–∞ —á–µ—Ä–µ–∑ API
curl -X POST http://localhost:5000/process_text \
  -H "Content-Type: application/json" \
  -d '{"text": "–≤–∞—à_xml_—Ç–µ–∫—Å—Ç"}'
```

## üéâ –†–µ–∑—É–ª—å—Ç–∞—Ç

–°–∏—Å—Ç–µ–º–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é –≥–æ—Ç–æ–≤–∞ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
- –û–±–Ω–∞—Ä—É–∂–∏–≤–∞–µ—Ç XML-—Ç–∞–±–ª–∏—Ü—ã –≤ –≤—ã–≤–æ–¥–µ OCR
- –ü–∞—Ä—Å–∏—Ç –∏—Ö –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç
- –ò–∑–≤–ª–µ–∫–∞–µ—Ç –∫–ª—é—á–µ–≤—ã–µ –ø–æ–ª—è –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
- –ü—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —É–¥–æ–±–Ω—ã–µ API –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏
- –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç –¥–∞–Ω–Ω—ã–µ –≤ —Ä–∞–∑–ª–∏—á–Ω—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã

–í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ–π–¥–µ–Ω—ã —É—Å–ø–µ—à–Ω–æ! ‚úÖ